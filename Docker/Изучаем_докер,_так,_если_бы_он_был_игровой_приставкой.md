<img src='https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/8650ad5e-4b5f-42e0-aa92-250947f569e3' align='center'>

<h1 align='center'>Изучаем докер, так, если бы он был игровой приставкой</h1>

Добро пожаловать в гайд по изучению `Docker`, в котором я проиллюстрирую вам совершенно иной подход при разработке ваших приложений с его помощью. Эту статью вы можете считать как **быстрый старт, введение в Docker**. Когда вы полностью прочитаете эту статью, уверен, вы поймёте, что такое `Docker`, для чего нужен, и где используется.

Но основным ключом к его освоению - это полное повторение процесса написания кода, как демонстрируется в этой статье. Это гайд по работе с **Docker для новичков**, потому, повторение процесса у себя на компьютере - **обязательное условие** к его пониманию. Одного чтения недостаточно, важно - повторение процесса и много практики. Так же чтобы наконец-то научиться работать с ним, даже при условии плохого понимая Docker-а, начните его уже применять в своей разработке. Начните, и увидите, как стали продвинутым его пользователем.  

Эта статья, в больше мере, нацелена на получение практических знаний, и только немного теории, построенной на аналогиях из жизни. 

> В этом туториале я показываю всё на примере **Windows 10**, делая все команды из консоли винды, и демонстрируя процесс установки Docker на Windows 10. Но, все команды будут работать аналогично и на Linux и Mac.

## Что вы узнаете из этой статьи
- [Что такое Docker](#что-такое-docker)
- [Зачем использовать Docker?](#зачем-использовать-docker?)
- [Установка Docker](#установка-docker)
- [Что такое Docker Image?](#что-такое-docker-image?)
- [Что такое Docker контейнер?](#что-такое-docker-контейнер?)
- Что такое Docker Volumes?
- Что такое Dockerfile?
- Как пробрасывать локальную папку в контейнер Докера (монтирование папки)?
- Как работают и пробрасываются Docker порты?
- Слои Docker образа, особенности создания образов.
- Что такое Docker-compose?
- Что такое микросервисы и микросервисная архитектура?


## Что такое Docker

На [сайте Докера](https://www.docker.com/) можно найти статью, в которой подробно рассказывается, что такое `Docker`. Из их слов - это стандартизированное ПО для разработки и развёртывания проектов.

Но, что это на самом деле значит?

Давайте на секунду забудем про Докер, и вспомним про такую ностальгическую штуку, как **GameBoy Color**:  
<h1 align='center'><img src='https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/edb08ae0-0671-4d59-85e5-0ccf45a1bfbf' height=500px></h1>

Если вы помните, игры для этой приставки поставлялись в виде картриджей:  
![image](https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/d4f009c1-bdee-41b8-8375-c474045b399c)

И я уверен в том, что производители видео игр пользуются успехом из-за своей простоты:
1. Когда ты хочешь поиграть, ты просто вставляешь картридж в приставку, и игра сразу же работает.
2. Ты можешь поделиться своей игрой с друзьями, передав всего лишь картридж, который они вставят в приставку, и сразу же смогут играть.

> Docker следует похожему принципу - позволяет запускать своё ПО настолько просто, что это соизмеримо с вставкой картриджа и нажатием кнопки ON на приставке.  
> Это основная суть, почему Docker настолько полезен - теперь кто угодно, у кого установлен Docker может запустить ваше приложение, выполнив для этого всего несколько команд.

Раньше вы, создавая приложения, к примеру, на PHP, устанавливали локально PHP, MySql, возможно, NodeJs, при этом устанавливая зависимости в виде нужных расширений и библиотек. И в случае передачи вашего скрипта какому-то знакомому ему требовалось настраивать аналогичное окружение, аналогичные версии, иметь аналогичные расширения и конфигурацию, чтобы успешно запустить ваше приложение.

Сейчас же, при использовании Докера, такой проблемы не возникнет впринципе. Теперь вам достаточно иметь установленную программу `Docker`, которая по одной вашей команде установит окружение, описанное в конфиге для запуска вашего приложения.


## Зачем использовать Docker?

**Кошмар при установке ПО**, с которым приходится сталкиваться. У вас когда-нибудь было такое, что вы пытаетесь установить ПО на ваш компьютер, а оно отказывается работать? Вы получаете несколько непонятных вам ошибок, из-за которых ничего не запускается. После нескольких часов гугления на десятой странице гугла на каком-то форуме до этого неизвестного вам вы, наконец-то, находите случайный комментарий, который помогает исправить вашу проблему.

Аналогично, что делает написание PC-игр более сложным, чем написание Game Boy игр - это то, что приходится проектировать систему с учётом большого множества существующих PC-девайсов и спецификаций. Так как разные компьютеры имеют различные операционные системы, драйвера, процессоры, графические карты, и т.д.
И потому задача разработчика достаточно затруднительна и трудоёмка - написать приложение совместимое со всеми популярными системами.

**Docker спасёт нас**. Docker, как и Game Boy приставка, берёт стандартизированные части программного обеспечения и запускает их так, как Game Boy запускал бы игру.

> В этом случае вы не должны беспокоиться об операционной системе, на которой пользователь будет запускать ваше приложение. Теперь, когда пользователи будут запускать приложение через Docker - конфигурация будет собрана автоматически, и код будет выполняться ВСЕГДА.

Как разработчик, теперь вы не должны волноваться о том, на какой системе будет запущено ваше приложение.
Как пользователь, вам не нужно волноваться о том, что вы скачаете неподходящую версию ПО (нужного для работы программы). В Докере эта программа будет запущена в аналогичных условиях, при которых это приложение было разработано, потому исключается факт получить какую-то новую, непредвиденную ошибку.

Для пользователя все действия сводятся к принципу **подключи и играй**.


## Установка Docker

Docker доступен для любой из операционных систем: `Windows`, `Linux`, `Max`. Для скачивания установочного файла перейдите по [ссылке](https://www.docker.com/products/docker-engine) и выберите подходящую вам версию. Я же, как и писал ранее, выбираю версию docker для Windows 10.

Docker предоставляет 2 сборки:
- **Community Edition** (полностью бесплатная версия)
- **Enterprise Edition** (платно). Содержит в себе дополнительные функции, которые, на данном этапе, точно не нужны.

Функциональность, которую мы будем использовать совершенно не отличается в этих двух сборках.  
После установки потребуется перезагрузка системы, и уже можно начинать полноценно работать с Докером.

Для того, чтобы проверить, запущен ли `Docker`, откроем командную строку (на Windows 10 - Нажмите кнопку windows, и начните писать командная строка)  
![image](https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/b539e63a-409a-447e-b101-15a84bd280fb)

Где, напишем команду docker, и в случае успешно работающего докера, получим ответ  
![image](https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/6f8733f8-9770-4864-9e4b-9e72a7fb416e)

Дальше, нужно удостовериться, что вместе с докером, доступен так же, `docker-compose`, для этого, выполним команду:  
```bash
docker-compose 
```
Вывод обеих команд будет примерно одинакового содержания.

> _Если вы используете Linux, то, docker-compose нужно будет устанавливать отдельно по [инструкции](https://docs.docker.com/compose/install/#install-compose)._


## Что такое Docker Image?

**Docker образ** (он же **Docker Image**), похож на Game Boy картридж - это просто программное обеспечение. Это стандартизированное программное обеспечение, которое запускается на любой приставке Game Boy. Вы можете дать игру вашему другу, и он сможет просто вставить картридж в приставку, и играть.

Как в случае с картриджами, бывают различные игры, так и Docker имеет различные образы ПО: `ubuntu`, `php`, `nodejs`, и т.д.

Рассмотрим пример скачивания нашего первого образа.  
Для этого, существует команда:  
```bash
docker pull <IMAGE_NAME>, где <IMAGE_NAME> - имя скачиваемого образа
```

Зная эту команду, скачаем образ `Ubuntu 18.10`:
```bash
docker pull ubuntu:18.10
```
![image](https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/a4ae0cb0-87ae-49ac-a521-9b746ac930ab)

Эта команда сообщает Докеру о том, что нужно скачать образ `Ubuntu 18.10` с [Dockerhub.com](https://hub.docker.com/) - основной репозиторий _Docker_-образов, на котором вы и можете посмотреть весь их список и подобрать нужный образ для вашей программы.

Это как поездка за новым картриджем в магазин, только намного быстрее :).

Теперь, для того, чтобы посмотреть список всех загруженных образов, нужно выполнить:
```bash
docker images
```

![image](https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/afcae0be-0c64-47e5-be55-ea46eebe097b)

У вас, как и на скрине, должен появиться только что скачанный образ `Ubuntu 18.10`. Чистый образ `Ubuntu` при установке из Docker-образа, весит всего **74 МБ**. Не чудо ли?

Проводя аналогии, команда `docker images` выглядит как коллекция картриджей от приставки, которые у вас есть сейчас:

<h1 align='center'>
  <img src='https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/f03a67b7-a2cf-4d2b-a49b-2ed3c7e156b9' height=300px>
</h1>


## Что такое Docker контейнер?

Теперь представьте, что мы обновили нашу приставку с Game Boy на GameCube. Игры хранятся на диске, который предназначен только для чтения самого образа игры. А прочие файлы (сохранения, кеш и т.д.) сохраняются внутри самой приставки, локально.

Так же, как и игра на диске, исходный Docker Image (образ) - **неизменяемый**.

> Docker контейнер - это экземпляр запущенного образа. Аналогично тому, что вы вставляете диск в приставку, после чего игра начинается.  
> А сам образ игры никак не модифицируется, все файлы, содержащие изменения хранятся где-то локально на приставке.  

<h1 align='center'><img src='https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/ca5edb5d-367f-43e5-be57-b54bac19631b' height=300px></h1>

> Запуск **Docker контейнера** соответствует тому, что вы играете в свою Gamecube игру. Docker запускает ваш образ в своей среде, аналогично тому, как Gamecube запускает игру с диска, не модифицируя оригинальный образ, а лишь сохраняя изменения и весь прогресс в какой-то песочнице.

Для запуска контейнера существует команда:
```bash
docker run <image> <опциональная команды, которая выполнится внутри контейнера>
```

Давайте запустим наш первый контейнер Ubuntu:
```bash
docker run ubuntu:18.10 echo 'hello from ubuntu'
```

Команда `echo 'hello from ubuntu'` была выполнена внутри среды `Ubuntu`. Другими словами, эта команда была выполнена в контейнере `ubuntu:18.10`.

Теперь выполним команду для проверки списка запущенных контейнеров:
```bash
docker ps
```

![image](https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/8f615f49-c170-491a-9d2f-398563d1cf12)

Здесь пустота... это потому что `docker ps` показывает только список контейнеров, которые **запущены** в данный момент (наш же контейнер выполнил одну команду `echo 'hello from ubuntu'` и завершил свою работу).

А для того, чтобы посмотреть список всех контейнеров без исключения, нужно добавить флаг `-a`, выполним:
```bash
docker ps -a
```

![image](https://github.com/Eytes/MyLibrary_CTF_and_programming/assets/67365128/e65b2dbf-6160-4f7b-9af6-759f4927b53b)

После выполнения нужных операций внутри контейнера, то Docker-контейнер завершает работу. Это похоже на режим сохранения энергии в новых игровых консолях - если вы не совершаете действий какое-то время, то система выключается автоматически.

Каждый раз, когда вы будете выполнять команду `docker run`, будет создаваться **новый контейнер**, на каждую из выполненных команд.

### Выполнение неограниченное количество команда внутри контейнера













